<%- include('navbar.ejs') %>

<!-- Form Page Content -->
<section class="form-group">
  <div class="container">
    <div class="form-wrapper">
      <h2>Update File Data</h2>
      <form action="/admin/update_file/<%=file_data.file_id%>" method="POST" enctype="multipart/form-data">
        <div class="form-group">
          <label for="image">File Image</label>
          <input type="file" name="file_img" accept="image/*">
          <img src="/admin/uploads/<%=file_data.file_img%>">
        </div>

        <div class="form-group">
          <label for="name">Design name</label>
          <input type="text" name="design_name" value="<%=file_data.design_name%>" required>
        </div>

                <div class="form-group">
  <label for="">Select Categories</label>
  <select name="category_name" id="category_name" required>
    <option value="<%=file_data.categories%>" disabled selected><%=file_data.categories%></option>
    <%for(let i=0; i< categoryName.length;i++){%>
    <option value="<%=categoryName[i].category_name%>"><%=categoryName[i].category_name%></option>
    <%}%>
  </select>
</div>

        <div class="form-group">
          <label for="price">File Price (₹)</label>
          <input type="number" name="file_price" id="file_price" value="<%=file_data.file_price%>" required>
        </div>

        <div class="form-group">
          <label for="file_dis">File Discount (%)</label>
          <input type="number" name="file_dis" id="file_dis" min="1" max="100" value="<%=file_data.file_dis%>" required>
        </div>

        <div class="form-group">
          <label for="final_price">Final Price (₹)</label>
          <input type="number" name="final_price" id="final_price" value="<%=file_data.final_price%>" readonly required>
        </div>

        <div class="form-group">
          <label for="file_view">File Views</label>
          <input type="number" name="file_view" id="file_view" value="<%=file_data.file_view%>" required>
        </div>

        <div class="form-group">
          <label for="file_perchesed">File Purchased</label>
          <input type="number" name="file_perchesed" id="file_perchesed" value="<%=file_data.file_perchesed%>" required>
        </div>

        <div class="form-group">
          <label for="file_des">File Description</label>
          <textarea name="file_des" rows="2" required><%=file_data.file_des%></textarea>
        </div>

        <button type="submit" class="submit-btn">Update File</button>
      </form>
    </div>
  </div>
</section>

<script>
  const priceInput = document.getElementById("file_price");
  const discountInput = document.getElementById("file_dis");
  const finalPriceInput = document.getElementById("final_price");

  function calculateFinalPrice() {
    const price = parseFloat(priceInput.value) || 0;
    const discount = parseFloat(discountInput.value) || 0;
    if (discount >= 1 && discount <= 100) {
      const discountAmount = (price * discount) / 100;
      finalPriceInput.value = Math.round(price - discountAmount);
    } else {
      finalPriceInput.value = price;
    }
  }

  priceInput.addEventListener("input", calculateFinalPrice);
  discountInput.addEventListener("input", calculateFinalPrice);
</script>

<%- include('footer.ejs') %>
